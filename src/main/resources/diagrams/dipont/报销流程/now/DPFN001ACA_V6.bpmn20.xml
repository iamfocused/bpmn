<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/processdef">
  <process id="CA_DPFN001A" name="CA_DPFN001A_各成本中心审批子流程 Expense Claim Costcenter Approval" isExecutable="true">
    <documentation>员工报销，明细中多成本中心拆分审批子流程 Expense Claim Costcenter Approval</documentation>
    <startEvent id="s1" name="s1" activiti:initiator="initiator">
      <extensionElements>
        <activiti:executionListener event="end" class="org.activiti.engine.impl.bpmn.listener.ScriptExecutionListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[import groovy.json.JsonSlurper;
				import groovy.json.JsonOutput;
				
				//处理学科数组及成本中心报销金额
				def tbhdexpdetfn01a_item = new JsonSlurper().parseText(execution.getVariable("tbhdexpdetfn01a_item"));
				def totalamount = 0;
				def mealExc = 0;//餐饮超标总金额
				def accommodationExc = 0;//住宿超标总金额
				def discipline = [];
				tbhdexpdetfn01a_item.each{
					if (it.key=='rows') {
						it.value =it.value.findAll { it[1].code == execution.getVariable("costCenter") }
						it.value.each{
							def amount = new java.math.BigDecimal(it[14]).setScale(2, java.math.RoundingMode.HALF_UP);
							totalamount += amount;
							
							if(it[11]) {
								def mealAmount = new java.math.BigDecimal(it[11]).setScale(2, java.math.RoundingMode.HALF_UP);
								mealExc += mealAmount;
							}
							
							if(it[13]) {
								def hotelAmount = new java.math.BigDecimal(it[13]).setScale(2, java.math.RoundingMode.HALF_UP);
								accommodationExc += hotelAmount;
							}
							discipline << it[24];
						}
					}
				}
				execution.setVariable("tbhdexpdetfn01a_item",JsonOutput.toJson(tbhdexpdetfn01a_item));
				execution.setVariable("totalamount",totalamount+"");

				if(mealExc > 0)
					execution.setVariable("mealExc","超标,详见明细");
				else
					execution.setVariable("mealExc","无超标");
					
				if(accommodationExc > 0)
					execution.setVariable("accommodationExc","超标,详见明细");
				else
					execution.setVariable("accommodationExc","无超标");
				
				//设置成本中心审批人
				def costCenterDrools = new JsonSlurper().parseText(execution.getVariable("costCenterDrools"));
				def localcostCenterDrools = costCenterDrools.find { elem -> elem.costcenter == execution.getVariable("costCenter")}
				def localVerifiers =[];
				//设置一级二级三级审批人
				localVerifiers << localcostCenterDrools.verifierfirst;
				localVerifiers << localcostCenterDrools.verifiersecond;
				localVerifiers << localcostCenterDrools.verifierthird;
				//当一级审批人为报销人时，审批人替换成reverifierfirst，reverifierfirst配置成a,b,....  a为一级审批人，b为二级审批人,目前最多支持三级
				if(localVerifiers[0] == execution.getVariable("claimsn")){
					try{
						if(localcostCenterDrools.reverifierfirst)
							localVerifiers = localcostCenterDrools.reverifierfirst.split(",").toList();
					}catch(Exception e) {
						throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
					}
				}
				if(localVerifiers[1] == execution.getVariable("claimsn")){
					try{
						if(localcostCenterDrools.reverifiersecond)
							localVerifiers = localcostCenterDrools.reverifiersecond.split(",").toList();
					}catch(Exception e) {
						throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
					}
				}
				if(localVerifiers[2] == execution.getVariable("claimsn")){
					try{
						if(localcostCenterDrools.reverifierthird)
							localVerifiers = localcostCenterDrools.reverifierthird.split(",").toList();
					}catch(Exception e) {
						throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
					}
				}
				localVerifiers.removeAll([null, ""]);
				execution.setVariable("level",localVerifiers.size());
				execution.setVariable("verifiers",localVerifiers);

				if(localcostCenterDrools.concurrent){
					localVerifiers.clear();
					localVerifiers << localcostCenterDrools.concurrent;
					execution.setVariable("verifiers",localVerifiers);
					execution.setVariable("level",99);
					
					//当并联审批人为报销人时，审批人替换成reverifierfirst，reverifierfirst配置成a,b,....  a为一级审批人，b为二级审批人,目前最多支持三级
					if(localVerifiers[0].contains(execution.getVariable("claimsn"))){
						try{
							if(localcostCenterDrools.reverifierfirst) {
								localVerifiers = localcostCenterDrools.reverifierfirst.split(",").toList();
								execution.setVariable("level",localVerifiers.size());
								execution.setVariable("verifiers",localVerifiers);
							}
						}catch(Exception e) {
							throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
						}

					}
				}
				
				if(localVerifiers.size() == 0) {
					throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人不存在，请联系管理员");
				}
				


				
				//SET BUSINESSKEY
				runtimeService.updateBusinessKey(execution.getProcessInstanceId(),execution.getVariable("businessKey"));
				
				//JUDGE BUDGET
				execution.setVariable("judgeBudget","无超标");
				for (item in discipline.unique()) {
					def c_d_budget = new JsonSlurper().parseText(execution.getVariable("allBudget")).find() { elem ->
						(elem.costcenter == execution.getVariable("costCenter") && elem.discipline == item)
					}
					if ((c_d_budget ? c_d_budget.remain_amount > 0: true) == false){
						execution.setVariable("judgeBudget","超标,详见报表");
						break;
					}
				}
				
				//GATEWAY JUDGE
				execution.setVariable('special',localcostCenterDrools.special)
				
				//BUDGET VIEW
				import javax.crypto.Mac;
				import javax.crypto.spec.SecretKeySpec;
				import java.security.InvalidKeyException;
				import java.util.Base64;
				def hmac_sha256(String secretKey, String data) {
					try {
						Mac mac = Mac.getInstance("HmacSHA256");
						SecretKeySpec secretKeySpec = new SecretKeySpec(secretKey.getBytes(), "HmacSHA256");
						mac.init(secretKeySpec);
						byte[] digest = mac.doFinal(data.getBytes());
						return digest;
					} catch (InvalidKeyException e) {
						throw new RuntimeException("Invalid key exception while converting to HMacSHA256");
					}
				}
				def METABASE_SITE_URL = "https://metabase.eorionsolution.com";
				def METABASE_SECRET_KEY = "8322aa8500b6ae07df7590b25d1bff56cb5e631dc829704c15cb66e80fed9f50";
				def header = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9";//=Base64.getUrlEncoder().encodeToString('{"typ":"JWT","alg":"HS256"}'.bytes);
				def playloadString = '{"resource":{"question":16},"params":{"costcenter_code":"'+execution.getVariable("costCenter")+'","apply_time":'+execution.getVariable("verifydate")+'}}';
				def playload = Base64.getUrlEncoder().encodeToString(playloadString.bytes);

				def secret =Base64.getUrlEncoder().encodeToString(hmac_sha256(METABASE_SECRET_KEY , header+'.'+playload));
				def url = METABASE_SITE_URL + "/embed/question/" + header+'.'+playload+'.'+secret + "#bordered=true&titled=false";
				execution.setVariable("BBOT_BI_BUDGET",url);
				execution.setVariable("BBOT_BI_BUDGET1",'https://metabase.eorionsolution.com/embed/question/eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyZXNvdXJjZSI6eyJxdWVzdGlvbiI6MzB9LCJwYXJhbXMiOnt9fQ.KOJVBvRfd0vog66lEjGd9p4cKoM0RFyXDizm0t5Msno#bordered=true&titled=true');]]></activiti:string>
          </activiti:field>
        </activiti:executionListener>
      </extensionElements>
    </startEvent>
    <userTask id="UT1_1" name="成本中心1级审批 Costcenter Level1 Approval" activiti:assignee="${verifiers[0]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level1_1" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level1_1"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();											
				def supeerExecution = runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult();
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level1_1'));
				
				
				def user = identityService.createUserQuery().userId(task.getExecution().getVariable('verifiers')[0]).singleResult(); 
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <userTask id="UT2_1" name="成本中心1级审批 Costcenter Level1 Approval" activiti:assignee="${verifiers[0]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level2_1" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level2_1"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();								
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level2_1'));
				
				def user = identityService.createUserQuery().userId(task.getExecution().getVariable('verifiers')[0]).singleResult(); 
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <userTask id="UT2_2" name="成本中心2级审批 Costcenter Level2 Approval" activiti:assignee="${verifiers[1]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level2_2" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level2_2"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();							
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level2_2'));
				
				def user = identityService.createUserQuery().userId(task.getExecution().getVariable('verifiers')[1]).singleResult(); 
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <userTask id="UT3_1" name="成本中心1级审批 Costcenter Level1 Approval" activiti:assignee="${verifiers[0]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level3_1" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level3_1"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();								
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level3_1'));
				
				def user = identityService.createUserQuery().userId(task.getExecution().getVariable('verifiers')[0]).singleResult(); 
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <userTask id="UT3_2" name="成本中心2级审批 Costcenter Level2 Approval" activiti:assignee="${verifiers[1]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level3_2" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level3_2"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();								
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level3_2'));
				
				def user = identityService.createUserQuery().userId(task.getExecution().getVariable('verifiers')[1]).singleResult(); 
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <userTask id="UT3_3" name="成本中心3级审批 Costcenter Level3 Approval" activiti:assignee="${verifiers[2]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level3_3" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level3_3"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();								
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level3_3'));
				
				def user = identityService.createUserQuery().userId(task.getExecution().getVariable('verifiers')[2]).singleResult(); 
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="sq1" name="1级" sourceRef="exclusivegateway1" targetRef="UT1_1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('level') == 1}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sq2" name="2级" sourceRef="exclusivegateway1" targetRef="UT2_1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('level') == 2}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sq3" name="3级" sourceRef="exclusivegateway1" targetRef="UT3_1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('level') == 3}]]></conditionExpression>
    </sequenceFlow>
    <endEvent id="E1" name="E1"></endEvent>
    <exclusiveGateway id="exclusivegateway1" name="g1"></exclusiveGateway>
    <exclusiveGateway id="exclusivegateway3" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow5" sourceRef="UT1_1" targetRef="exclusivegateway3"></sequenceFlow>
    <endEvent id="END_LEVEL1_N" name="END_LEVEL1_N"></endEvent>
    <sequenceFlow id="seq1_1_Y" name="同意" sourceRef="exclusivegateway3" targetRef="E1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level1_1') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq1_1_N" name="拒绝" sourceRef="exclusivegateway3" targetRef="END_LEVEL1_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level1_1') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq2_1_Y" name="同意" sourceRef="exclusivegateway4" targetRef="UT2_2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level2_1') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq2_2_Y" name="同意" sourceRef="exclusivegateway5" targetRef="E1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level2_2') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq2_1_N" name="拒绝" sourceRef="exclusivegateway4" targetRef="END_LEVEL2_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level2_1') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq2_2_N" name="拒绝" sourceRef="exclusivegateway5" targetRef="END_LEVEL2_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level2_2') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq3_1_Y" name="同意" sourceRef="exclusivegateway6" targetRef="UT3_2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level3_1') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq3_2_Y" name="同意" sourceRef="exclusivegateway7" targetRef="UT3_3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level3_2') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq3_3_Y" name="同意" sourceRef="exclusivegateway8" targetRef="E1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level3_3') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq3_1_N" name="拒绝" sourceRef="exclusivegateway6" targetRef="END_LEVEL3_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level3_1') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq3_2_N" name="拒绝" sourceRef="exclusivegateway7" targetRef="END_LEVEL3_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level3_2') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq3_3_N" name="拒绝" sourceRef="exclusivegateway8" targetRef="END_LEVEL3_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level3_3') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sq4" name="并发审批" sourceRef="exclusivegateway1" targetRef="UT4">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('level') == 99}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="UT4" name="并发审批" activiti:candidateUsers="${verifiers[0]}" activiti:dueDate="P1D" activiti:priority="8080">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level4" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level4"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = task.getExecution().getSuperExecutionId();								
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level4'));
				
				

				def user = identityService.createUserQuery().userId(task.getAssignee()).singleResult();
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="seq4_N" sourceRef="exclusivegateway9" targetRef="END_LEVEL4_N">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level4') == '拒绝'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="seq4_Y" sourceRef="exclusivegateway9" targetRef="E1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('coreaction_level4') == '同意'}]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="exclusivegateway4" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow7" sourceRef="UT2_1" targetRef="exclusivegateway4"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway5" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow8" sourceRef="UT2_2" targetRef="exclusivegateway5"></sequenceFlow>
    <endEvent id="END_LEVEL2_N" name="END_LEVEL2_N"></endEvent>
    <sequenceFlow id="flow9" sourceRef="s1" targetRef="exclusivegateway10"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway6" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow11" sourceRef="UT3_1" targetRef="exclusivegateway6"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway7" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow13" sourceRef="UT3_2" targetRef="exclusivegateway7"></sequenceFlow>
    <endEvent id="END_LEVEL3_N" name="END_LEVEL3_N"></endEvent>
    <exclusiveGateway id="exclusivegateway8" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow16" sourceRef="UT3_3" targetRef="exclusivegateway8"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway9" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow17" sourceRef="UT4" targetRef="exclusivegateway9"></sequenceFlow>
    <endEvent id="END_LEVEL4_N" name="End"></endEvent>
    <exclusiveGateway id="exclusivegateway10" name="g10"></exclusiveGateway>
    <sequenceFlow id="flow18" name="正常审批" sourceRef="exclusivegateway10" targetRef="exclusivegateway1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('special') == 'N'}]]></conditionExpression>
    </sequenceFlow>
    <subProcess id="subprocess1" name="Sub Process">
      <multiInstanceLoopCharacteristics isSequential="false" activiti:collection="mergeResult" activiti:elementVariable="list">
        <completionCondition>${CurApprovalResults=="拒绝"}</completionCondition>
      </multiInstanceLoopCharacteristics>
      <startEvent id="startevent1" name="SubStart">
      	<extensionElements>
      		<activiti:executionListener event="start" class="org.activiti.engine.impl.bpmn.listener.ScriptExecutionListener">
	          <activiti:field name="language">
	            <activiti:string><![CDATA[groovy]]></activiti:string>
	          </activiti:field>
	          <activiti:field name="script">
	            <activiti:string><![CDATA[
	            		import groovy.json.JsonSlurper;
						import groovy.json.JsonOutput;
						
						def jsonSlurper = new JsonSlurper()
	            		def list = jsonSlurper.parseText(execution.getVariable('list'))
	            		
						def localVerifiers = [];
						//设置成本中心审批人
						localVerifiers<<list.verifierfirst
						localVerifiers<<list.verifiersecond
						localVerifiers<<list.verifierthird
						//当一级审批人为报销人时，审批人替换成reverifierfirst，reverifierfirst配置成a,b,....  a为一级审批人，b为二级审批人,目前最多支持三级
						if(localVerifiers[0] == execution.getVariable("claimsn")){
							try{
								if(list.reverifierfirst)
									localVerifiers = list.reverifierfirst.split(",").toList();
							}catch(Exception e) {
								throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
							}
						}
						if(localVerifiers[1] == execution.getVariable("claimsn")){
							try{
								if(list.reverifiersecond)
									localVerifiers = list.reverifiersecond.split(",").toList();
							}catch(Exception e) {
								throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
							}
						}
						if(localVerifiers[2] == execution.getVariable("claimsn")){
							try{
								if(list.reverifierthird)
									localVerifiers = list.reverifierthird.split(",").toList();
							}catch(Exception e) {
								throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心审批人设置错误，请联系管理员 Invalid Costcenter Approver");
							}
						}
						localVerifiers.removeAll([null, ""]);
						
						execution.setVariableLocal('users',localVerifiers)
						execution.setVariableLocal('usersStr',localVerifiers.toString())
						
						def tbhd_item = list.tbhd_items
						def totalamount = 0;
						def mealExc = 0;//餐饮超标总金额
						def accommodationExc = 0;//住宿超标总金额
						def discipline = [];
						tbhd_item.each{
							if (it.key=='rows') {
								it.value.each{
								def amount = new java.math.BigDecimal(it[14]).setScale(2, java.math.RoundingMode.HALF_UP);
								totalamount += amount;
								
								if(it[11]) {
									def mealAmount = new java.math.BigDecimal(it[11]).setScale(2, java.math.RoundingMode.HALF_UP);
									mealExc += mealAmount;
								}
								
								if(it[13]) {
									def hotelAmount = new java.math.BigDecimal(it[13]).setScale(2, java.math.RoundingMode.HALF_UP);
									accommodationExc += hotelAmount;
								}
								discipline << it[24];
								}
							}
						}
						execution.setVariableLocal("totalamount",totalamount+"");

						if(mealExc > 0)
							execution.setVariableLocal("mealExc","超标,详见明细");
						else
							execution.setVariableLocal("mealExc","无超标");
							
						if(accommodationExc > 0)
							execution.setVariableLocal("accommodationExc","超标,详见明细");
						else
							execution.setVariableLocal("accommodationExc","无超标");
							
						execution.setVariableLocal('tbhdexpdetfn01a_item',JsonOutput.toJson(tbhd_item))
						
						//SET BUSINESSKEY
						runtimeService.updateBusinessKey(execution.getProcessInstanceId(),execution.getVariable("businessKey"));
					]]></activiti:string>
	          </activiti:field>
        	</activiti:executionListener>
      	</extensionElements>
      </startEvent>
      <exclusiveGateway id="exclusivegateway11" name="g11"></exclusiveGateway>
      <sequenceFlow id="flow19" sourceRef="startevent1" targetRef="exclusivegateway11"></sequenceFlow>
      <userTask id="usertask1" name="串行多级审批" activiti:assignee="${user}">
      	<extensionElements>
        <activiti:formProperty id="coreaction_审批结果 Approval_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="approvalResults" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见 Comments_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="approvalComments"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>		
		<activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>		
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[
            	def execution = task.getExecution()
            	def approvalResults = execution.getVariable('approvalResults')
            	execution.setVariableLocal('approvalResultsLocal',approvalResults)
            	execution.setVariable('CurApprovalResults',approvalResults)
            	def approvalComments = execution.getVariable('approvalComments')
            	execution.setVariableLocal('approvalCommentsLocal','approvalComments')
            	
            	def superExecutionId = execution.getVariable('superExecutionId')						
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', approvalResults);
				
				

				def user = identityService.createUserQuery().userId(task.getAssignee()).singleResult();
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);
            ]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="create" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[
            	def execution = task.getExecution()
            	execution.setVariableLocal('approvalResults','')
            	execution.setVariableLocal('approvalComments','')
            ]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
       </extensionElements>
        <multiInstanceLoopCharacteristics isSequential="true" activiti:collection="users" activiti:elementVariable="user">
          <completionCondition>${CurApprovalResults=='拒绝'}</completionCondition>
        </multiInstanceLoopCharacteristics>
      </userTask>
      <userTask id="usertask2" name="并发审批" activiti:assignee="${verifiers[0]}">
      <extensionElements>
        <activiti:formProperty id="coreaction_审批结果_1_enum_rbv_$$A" name="审批结果 Approval" type="enum" variable="coreaction_level4" required="true">
          <activiti:value id="同意" name="同意 Y"></activiti:value>
          <activiti:value id="拒绝" name="拒绝 N"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="corecomments_审批意见_1_string_t2_$$B" name="审批意见 Comments" type="string" variable="corecomments_level4"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额大写 Total Amount_0_string_cny_$$VB" name="报销总金额大写 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="totalexpamt_报销总金额 Total Amount_1_string_t11_$$VB" name="报销总金额 Total Amount" type="string" variable="totalamount"></activiti:formProperty>
        <activiti:formProperty id="claimname_实际报销人 Claim to_2_string_t1_$$VB" name="实际报销人 Claim to" type="string" variable="claimname"></activiti:formProperty>
        <activiti:formProperty id="currency_货币 Currency_3_enum_sbs_$$VB" name="货币 Currency" type="string" variable="currency"></activiti:formProperty>
        <activiti:formProperty id="comments_报销说明 Comments_4_string_t1_$$VB" name="报销说明 Comments" type="string" variable="comments"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额大写 Total Deduction Amount_5_string_cny_$$VB" name="冲销金额大写 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="againstamount_冲销金额 Total Deduction Amount_6_string_t11_$$VB" name="冲销金额 Total Deduction Amount" type="string" variable="againstamount"></activiti:formProperty>
        <activiti:formProperty id="corp_实体 Corp ID_7_string_t1_$$VB" name="所属实体 Corp ID" type="string" variable="corpname"></activiti:formProperty>
        <activiti:formProperty id="judgebudget_预算管理 Budget_1_string_t1_$$VC" name="预算管理 Budget" type="string" variable="judgeBudget"></activiti:formProperty>
        <activiti:formProperty id="mealexc_餐饮超标情况 Meal Exc._2_string_t1_$$VC" name="餐饮超标情况 Meal Exc." type="string" variable="mealExc"></activiti:formProperty>
        <activiti:formProperty id="accommodationexc_住宿超标情况 Accommodation Exc._3_string_t1_$$VC" name="住宿超标情况 Accommodation Exc." type="string" variable="accommodationExc"></activiti:formProperty>
        <activiti:formProperty id="attachment_附件_1_string_t9_$$VF" name="附件" type="string" variable="attachment"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_item_$$VA" name="报销明细 Details" type="string" variable="tbhdexpdetfn01a_item"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_收支项目a Payment item_ioitem_0_string_tree_$$VA" name="收支项目 Payment item" type="string" variable="tbhdexpdetfn01a_ioitem_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_成本中心 Costcenter_costcenter_1_string_tree_$$VA" name="成本中心 Costcenter" type="string" variable="tbhdexpdetfn01a_costcenter_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_项目 Project_project_2_string_tree_$$VA" name="项目 Project" type="string" variable="tbhdexpdetfn01a_project_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_开始时间 Start Time_depdate_3_string_t3_$$VA" name="开始时间 Start Time" type="string" variable="tbhdexpdetfn01a_depdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_结束时间 End Time_arrdate_4_string_t3_$$VA" name="结束时间 End Time" type="string" variable="tbhdexpdetfn01a_arrdate_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_几类城市 City Category_citytype_5_enum_sbs_$$VA" name="几类城市 City Category" type="string" variable="tbhdexpdetfn01a_citytype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出发地 Departure_departure_6_string_t1_$$VA" name="出发地 Departure" type="string" variable="tbhdexpdetfn01a_departure_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_目的地 Destination_destination_7_string_t1_$$VA" name="目的地 Destination" type="string" variable="tbhdexpdetfn01a_destination_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差地点 Travel to_desloc_8_string_t1_$$VA" name="出差地点 Travel to" type="string" variable="tbhdexpdetfn01a_desloc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_出差天数 Travel days_arrivaldays_9_string_t6_$$VA" name="出差天数 Travel days" type="string" variable="tbhdexpdetfn01a_arrivaldays_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费标准 Meal Std._mealstd_10_string_t11_$$VA" name="餐饮费标准 Meal Std." type="string" variable="tbhdexpdetfn01a_mealstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_餐饮费超标金额 Meal Exc._mealextra_11_string_t11_$$VA" name="餐饮费超标金额 Meal Exc." type="string" variable="tbhdexpdetfn01a_mealetra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费标准 Accommodation Std._hotelstd_12_string_t11_$$VA" name="住宿费标准 Accommodation Std." type="string" variable="tbhdexpdetfn01a_hotelstd_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_住宿费超标金额 Accommodation Exc._hotelextra_13_string_t11_$$VA" name="住宿费超标金额 Accommodation Exc." type="string" variable="tbhdexpdetfn01a_hotelextra_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_金额 Amount_amount_14_string_cny_$$VA" name="金额 Amount" type="string" variable="tbhdexpdetfn01a_amount_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_税额 Tax_tax_15_string_cny_$$VA" name="税额 Tax" type="string" variable="tbhdexpdetfn01a_tax_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_航班类型 Flight Type_flighttype_16_enum_sbs_$$VA" name="航班类型 Flight Type" type="string" variable="tbhdexpdetfn01a_flighttype_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机票价 Air Fare_airfare_17_string_cny_$$VA" name="机票价 Air Fare" type="string" variable="tbhdexpdetfn01a_airfare_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_燃油附加费 YQ_yq_18_string_cny_$$VA" name="燃油附加费 YQ" type="string" variable="tbhdexpdetfn01a_yq_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_机场建设费 CN_cn_19_string_cny_$$VA" name="机场建设费 CN" type="string" variable="tbhdexpdetfn01a_cn_t00"></activiti:formProperty>		
		<activiti:formProperty id="tbhdexpdetfn01a_发票数量 Qty Invoiced_qtyinvoiced_20_string_t6_$$VA" name="发票数量 Qty Invoiced" type="string" variable="tbhdexpdetfn01a_qtyinvoiced_t00"></activiti:formProperty>		
        <activiti:formProperty id="tbhdexpdetfn01a_备注信息 Note_expdetail_21_string_t1_$$VA" name="备注信息 Note" type="string" variable="tbhdexpdetfn01a_expdetail_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_利润中心 Profit Center_profitacc_22_string_t1_$$HA" name="利润中心 Profit Center" type="string" variable="tbhdexpdetfn01a_profitacc_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_设备类别 Equipment Type_category_23_string_tree_$$VA" name="设备类别 Equipment Type" type="string" variable="tbhdexpdetfn01a_category_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_学科 Subject_discipline_24_enum_sbs_$$VA" name="学科 Subject" type="string" variable="tbhdexpdetfn01a_discipline_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_差旅申请号 Travel Request No_application_25_string_auto_$$VA" name="差旅申请号 Travel Request No" type="string" variable="tbhdexpdetfn01a_application_t00"></activiti:formProperty>
        <activiti:formProperty id="tbhdexpdetfn01a_供应商 Vendor_vendor_26_string_auto_$$VA" name="供应商 Vendor" type="string" variable="tbhdexpdetfn01a_vendor_t00"></activiti:formProperty>
        <activiti:taskListener event="complete" class="org.activiti.engine.impl.bpmn.listener.ScriptTaskListener">
          <activiti:field name="language">
            <activiti:string><![CDATA[groovy]]></activiti:string>
          </activiti:field>
          <activiti:field name="script">
            <activiti:string><![CDATA[def superExecutionId = def superExecutionId = execution.getVariable('superExecutionId')							
				def supeerExecution =	runtimeService.createExecutionQuery().executionId(superExecutionId).singleResult(); 
				supeerExecution.setVariable('coreaction', task.getExecution().getVariable('coreaction_level4'));
				
				

				def user = identityService.createUserQuery().userId(task.getAssignee()).singleResult();
				def username = user.getLastName() + " " + user.getFirstName();
				supeerExecution.setVariable('costcentermemo', supeerExecution.getVariable('costcentermemo')+'/'+username);]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>	
      </userTask>
      <sequenceFlow id="flow20" name="并发审批" sourceRef="exclusivegateway11" targetRef="usertask2">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('level') == 99}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow21" name="串行审批" sourceRef="exclusivegateway11" targetRef="usertask1">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('level') != 99}]]></conditionExpression>
      </sequenceFlow>
      <exclusiveGateway id="exclusivegateway12" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow22" sourceRef="usertask2" targetRef="exclusivegateway12"></sequenceFlow>
      <sequenceFlow id="flow23" sourceRef="usertask1" targetRef="exclusivegateway12"></sequenceFlow>
      <endEvent id="endevent1" name="End"></endEvent>
      <sequenceFlow id="flow24" sourceRef="exclusivegateway12" targetRef="endevent1"></sequenceFlow>
    </subProcess>
    <sequenceFlow id="flow25" name="特殊审批（成本中心&amp;项目&amp;金额&amp;收支项目）" sourceRef="exclusivegateway10" targetRef="scripttask1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${execution.getVariable('special') == 'Y'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow26" sourceRef="subprocess1" targetRef="E1"></sequenceFlow>
    <scriptTask id="scripttask1" name="Drools" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script><![CDATA[
    			import groovy.json.JsonSlurper;
				import groovy.json.JsonOutput;
    			def tbhdexpdetfn01a_item = new JsonSlurper().parseText(execution.getVariable("tbhdexpdetfn01a_item"))
    			def specialDrools = []
    			tbhdexpdetfn01a_item.rows.groupBy { item -> item[1].code + "_" + item[2].code }.each
		        {k, v ->
		            def curAmount = 0
		            def ioitems = new HashSet()
		            v.each{
		                def amount = new java.math.BigDecimal(it[14]).setScale(2, java.math.RoundingMode.HALF_UP)
		                curAmount += amount
		                ioitems.add(it[0].code)
		            }
		            def keyArr = k.split('_')
		            def costCenter = keyArr[0]
		            def project = keyArr[1]
		            ioitems.each {
		                specialDrools<<"""{"costcenter":"${costCenter}","project":"${project}","amount":"${curAmount}","ioitem":"${it}"}"""
		            }
		        }
		        execution.setVariable("_http_method", "POST");
				def headerMap = new java.util.HashMap<String,String>();
				headerMap.put("Content-Type","application/json");				
				execution.setVariable("_http_headers", headerMap);

				execution.setVariable("_http_body", specialDrools.toString());
				execution.setVariable("_http_url", 'https://commonservices.eorionsolution.com/decisiontables/v1/fire/ccfn01a_special.xls');
				execution.setVariable("_http_response_body", '');
			    execution.setVariable("_http_response_status_code", '');
    		]]>
    	</script>
    </scriptTask>
    <serviceTask id="servicetask1" name="Drools调用" activiti:class="com.eorionsolution.riying.bpms.javaservice.http.RestAPIService"></serviceTask>
    <sequenceFlow id="flow27" sourceRef="scripttask1" targetRef="servicetask1"></sequenceFlow>
    <scriptTask id="scripttask2" name="结果解析" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script><![CDATA[
    			import groovy.json.JsonSlurper;
				import groovy.json.JsonOutput;
				
    			if(execution.getVariable('_http_response_status_code') != 200) {
    				throw new org.activiti.engine.ActivitiIllegalArgumentException("Drools调用查询审批人异常，请联系管理员！");
    			}
    			def jsonSlurper = new JsonSlurper()
    			def responseBody = execution.getVariable('_http_response_body')
    			execution.setVariable('specialDrools', responseBody)
    			def droolsResult = jsonSlurper.parseText(responseBody)
    			droolsResult.each{
    				if(it.verifierfirst == null) {
    					throw new org.activiti.engine.ActivitiIllegalArgumentException("成本中心：" + it.costcenter + " 项目：" + it.project + " 收支项目：" + it.ioitem + " 金额：" + it.amount + " 对应的审批人不存在！");
    				}
    			}
    			
    			//Drools结果处理
    			def mergeResult = []
    			//根据Drools规则分组
    			def groupMap = droolsResult.groupBy { it.ruleno }
    			groupMap.each {
				    def projects = new HashSet()
				    def ioitems = new HashSet()
				    it.value.each {
				        item -> projects << item.project; ioitems << item.ioitem
				    }
				    it.value[0].project = projects.join(",")
				    it.value[0].ioitem = ioitems.join(",")
				    mergeResult << it.value[0]
				}
				mergeResult.each {
				    def tbhdexpdetfn01a_item = jsonSlurper.parseText(execution.getVariable("tbhdexpdetfn01a_item"))
				    tbhdexpdetfn01a_item.each {item->
				        if (item.key == 'rows') {
				            item.value = item.value.findAll { i -> it.ioitem.split(",").contains(i[0].code) && it.project.split(",").contains(i[2].code) }
				        }
				    }
				    it.put('tbhd_items',tbhdexpdetfn01a_item)
				}
				mergeResult.each{it = JsonOutput.toJson(it)}
				
				def mergeResult1 = []
				mergeResult.each {mergeResult1<<JsonOutput.toJson(it)}
				execution.setVariable('mergeResult',mergeResult1)	
				
				execution.setVariable('superExecutionId',execution.getSuperExecutionId())			
    		]]>
    	</script>
    </scriptTask>
    <sequenceFlow id="flow28" sourceRef="servicetask1" targetRef="scripttask2"></sequenceFlow>
    <sequenceFlow id="flow29" sourceRef="scripttask2" targetRef="subprocess1"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_CA_DPFN001A">
    <bpmndi:BPMNPlane bpmnElement="CA_DPFN001A" id="BPMNPlane_CA_DPFN001A">
      <bpmndi:BPMNShape bpmnElement="s1" id="BPMNShape_s1">
        <omgdc:Bounds height="35.0" width="35.0" x="1.0" y="272.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT1_1" id="BPMNShape_UT1_1">
        <omgdc:Bounds height="72.0" width="105.0" x="363.0" y="122.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT2_1" id="BPMNShape_UT2_1">
        <omgdc:Bounds height="69.0" width="105.0" x="363.0" y="255.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT2_2" id="BPMNShape_UT2_2">
        <omgdc:Bounds height="69.0" width="105.0" x="579.0" y="255.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT3_1" id="BPMNShape_UT3_1">
        <omgdc:Bounds height="71.0" width="105.0" x="363.0" y="378.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT3_2" id="BPMNShape_UT3_2">
        <omgdc:Bounds height="71.0" width="105.0" x="566.0" y="378.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT3_3" id="BPMNShape_UT3_3">
        <omgdc:Bounds height="71.0" width="105.0" x="771.0" y="378.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="E1" id="BPMNShape_E1">
        <omgdc:Bounds height="35.0" width="35.0" x="991.0" y="272.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="221.0" y="269.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway3" id="BPMNShape_exclusivegateway3">
        <omgdc:Bounds height="40.0" width="40.0" x="502.0" y="137.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="END_LEVEL1_N" id="BPMNShape_END_LEVEL1_N">
        <omgdc:Bounds height="35.0" width="35.0" x="505.0" y="68.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UT4" id="BPMNShape_UT4">
        <omgdc:Bounds height="65.0" width="105.0" x="363.0" y="500.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway4" id="BPMNShape_exclusivegateway4">
        <omgdc:Bounds height="40.0" width="40.0" x="511.0" y="269.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway5" id="BPMNShape_exclusivegateway5">
        <omgdc:Bounds height="40.0" width="40.0" x="707.0" y="269.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="END_LEVEL2_N" id="BPMNShape_END_LEVEL2_N">
        <omgdc:Bounds height="35.0" width="35.0" x="601.0" y="199.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway6" id="BPMNShape_exclusivegateway6">
        <omgdc:Bounds height="40.0" width="40.0" x="502.0" y="393.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway7" id="BPMNShape_exclusivegateway7">
        <omgdc:Bounds height="40.0" width="40.0" x="703.0" y="393.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="END_LEVEL3_N" id="BPMNShape_END_LEVEL3_N">
        <omgdc:Bounds height="35.0" width="35.0" x="706.0" y="340.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway8" id="BPMNShape_exclusivegateway8">
        <omgdc:Bounds height="40.0" width="40.0" x="912.0" y="393.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway9" id="BPMNShape_exclusivegateway9">
        <omgdc:Bounds height="40.0" width="40.0" x="513.0" y="513.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="END_LEVEL4_N" id="BPMNShape_END_LEVEL4_N">
        <omgdc:Bounds height="35.0" width="35.0" x="516.0" y="580.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway10" id="BPMNShape_exclusivegateway10">
        <omgdc:Bounds height="40.0" width="40.0" x="101.0" y="269.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="subprocess1" id="BPMNShape_subprocess1">
        <omgdc:Bounds height="235.0" width="627.0" x="278.0" y="650.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="311.0" y="749.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway11" id="BPMNShape_exclusivegateway11">
        <omgdc:Bounds height="40.0" width="40.0" x="411.0" y="746.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask1" id="BPMNShape_usertask1">
        <omgdc:Bounds height="68.0" width="121.0" x="501.0" y="783.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask2" id="BPMNShape_usertask2">
        <omgdc:Bounds height="71.0" width="121.0" x="501.0" y="670.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway12" id="BPMNShape_exclusivegateway12">
        <omgdc:Bounds height="40.0" width="40.0" x="701.0" y="740.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="786.0" y="743.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask1" id="BPMNShape_scripttask1">
        <omgdc:Bounds height="63.0" width="112.0" x="66.0" y="418.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask1" id="BPMNShape_servicetask1">
        <omgdc:Bounds height="61.0" width="112.0" x="66.0" y="590.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask2" id="BPMNShape_scripttask2">
        <omgdc:Bounds height="60.0" width="108.0" x="68.0" y="741.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="sq1" id="BPMNEdge_sq1">
        <omgdi:waypoint x="241.0" y="269.0"></omgdi:waypoint>
        <omgdi:waypoint x="240.0" y="157.0"></omgdi:waypoint>
        <omgdi:waypoint x="363.0" y="158.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="18.0" x="279.0" y="170.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sq2" id="BPMNEdge_sq2">
        <omgdi:waypoint x="261.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="337.0" y="290.0"></omgdi:waypoint>
        <omgdi:waypoint x="363.0" y="289.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="18.0" x="278.0" y="288.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sq3" id="BPMNEdge_sq3">
        <omgdi:waypoint x="241.0" y="309.0"></omgdi:waypoint>
        <omgdi:waypoint x="240.0" y="416.0"></omgdi:waypoint>
        <omgdi:waypoint x="337.0" y="416.0"></omgdi:waypoint>
        <omgdi:waypoint x="363.0" y="413.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="18.0" x="267.0" y="417.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
        <omgdi:waypoint x="468.0" y="158.0"></omgdi:waypoint>
        <omgdi:waypoint x="502.0" y="157.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq1_1_Y" id="BPMNEdge_seq1_1_Y">
        <omgdi:waypoint x="542.0" y="157.0"></omgdi:waypoint>
        <omgdi:waypoint x="691.0" y="156.0"></omgdi:waypoint>
        <omgdi:waypoint x="894.0" y="156.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="156.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="272.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="542.0" y="157.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq1_1_N" id="BPMNEdge_seq1_1_N">
        <omgdi:waypoint x="522.0" y="137.0"></omgdi:waypoint>
        <omgdi:waypoint x="522.0" y="103.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="527.0" y="111.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq2_1_Y" id="BPMNEdge_seq2_1_Y">
        <omgdi:waypoint x="551.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="579.0" y="289.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="512.0" y="309.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq2_2_Y" id="BPMNEdge_seq2_2_Y">
        <omgdi:waypoint x="747.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="898.0" y="288.0"></omgdi:waypoint>
        <omgdi:waypoint x="991.0" y="288.0"></omgdi:waypoint>
        <omgdi:waypoint x="1026.0" y="289.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="747.0" y="289.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq2_1_N" id="BPMNEdge_seq2_1_N">
        <omgdi:waypoint x="531.0" y="269.0"></omgdi:waypoint>
        <omgdi:waypoint x="529.0" y="216.0"></omgdi:waypoint>
        <omgdi:waypoint x="601.0" y="216.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="514.0" y="211.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq2_2_N" id="BPMNEdge_seq2_2_N">
        <omgdi:waypoint x="727.0" y="269.0"></omgdi:waypoint>
        <omgdi:waypoint x="725.0" y="216.0"></omgdi:waypoint>
        <omgdi:waypoint x="636.0" y="216.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="668.0" y="217.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq3_1_Y" id="BPMNEdge_seq3_1_Y">
        <omgdi:waypoint x="542.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="566.0" y="413.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="517.0" y="434.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq3_2_Y" id="BPMNEdge_seq3_2_Y">
        <omgdi:waypoint x="743.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="771.0" y="413.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="716.0" y="433.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq3_3_Y" id="BPMNEdge_seq3_3_Y">
        <omgdi:waypoint x="952.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="307.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="952.0" y="413.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq3_1_N" id="BPMNEdge_seq3_1_N">
        <omgdi:waypoint x="522.0" y="393.0"></omgdi:waypoint>
        <omgdi:waypoint x="522.0" y="357.0"></omgdi:waypoint>
        <omgdi:waypoint x="706.0" y="357.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="534.0" y="357.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq3_2_N" id="BPMNEdge_seq3_2_N">
        <omgdi:waypoint x="723.0" y="393.0"></omgdi:waypoint>
        <omgdi:waypoint x="723.0" y="375.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="681.0" y="369.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq3_3_N" id="BPMNEdge_seq3_3_N">
        <omgdi:waypoint x="932.0" y="393.0"></omgdi:waypoint>
        <omgdi:waypoint x="930.0" y="357.0"></omgdi:waypoint>
        <omgdi:waypoint x="741.0" y="357.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="22.0" x="814.0" y="335.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sq4" id="BPMNEdge_sq4">
        <omgdi:waypoint x="241.0" y="309.0"></omgdi:waypoint>
        <omgdi:waypoint x="241.0" y="532.0"></omgdi:waypoint>
        <omgdi:waypoint x="363.0" y="532.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="44.0" x="261.0" y="539.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq4_N" id="BPMNEdge_seq4_N">
        <omgdi:waypoint x="533.0" y="553.0"></omgdi:waypoint>
        <omgdi:waypoint x="533.0" y="580.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="seq4_Y" id="BPMNEdge_seq4_Y">
        <omgdi:waypoint x="553.0" y="533.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="533.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="307.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
        <omgdi:waypoint x="468.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="511.0" y="289.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
        <omgdi:waypoint x="684.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="707.0" y="289.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow9" id="BPMNEdge_flow9">
        <omgdi:waypoint x="36.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="101.0" y="289.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
        <omgdi:waypoint x="468.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="502.0" y="413.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="671.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="703.0" y="413.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow16" id="BPMNEdge_flow16">
        <omgdi:waypoint x="876.0" y="413.0"></omgdi:waypoint>
        <omgdi:waypoint x="912.0" y="413.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="468.0" y="532.0"></omgdi:waypoint>
        <omgdi:waypoint x="513.0" y="533.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
        <omgdi:waypoint x="141.0" y="289.0"></omgdi:waypoint>
        <omgdi:waypoint x="221.0" y="289.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="44.0" x="141.0" y="289.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="346.0" y="766.0"></omgdi:waypoint>
        <omgdi:waypoint x="411.0" y="766.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow20" id="BPMNEdge_flow20">
        <omgdi:waypoint x="431.0" y="746.0"></omgdi:waypoint>
        <omgdi:waypoint x="431.0" y="705.0"></omgdi:waypoint>
        <omgdi:waypoint x="501.0" y="705.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="44.0" x="413.0" y="650.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow21" id="BPMNEdge_flow21">
        <omgdi:waypoint x="431.0" y="786.0"></omgdi:waypoint>
        <omgdi:waypoint x="431.0" y="817.0"></omgdi:waypoint>
        <omgdi:waypoint x="501.0" y="817.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="16.0" width="100.0" x="431.0" y="786.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow22" id="BPMNEdge_flow22">
        <omgdi:waypoint x="622.0" y="705.0"></omgdi:waypoint>
        <omgdi:waypoint x="720.0" y="705.0"></omgdi:waypoint>
        <omgdi:waypoint x="721.0" y="740.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow23" id="BPMNEdge_flow23">
        <omgdi:waypoint x="622.0" y="817.0"></omgdi:waypoint>
        <omgdi:waypoint x="720.0" y="816.0"></omgdi:waypoint>
        <omgdi:waypoint x="721.0" y="780.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow24" id="BPMNEdge_flow24">
        <omgdi:waypoint x="741.0" y="760.0"></omgdi:waypoint>
        <omgdi:waypoint x="786.0" y="760.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow25" id="BPMNEdge_flow25">
        <omgdi:waypoint x="121.0" y="309.0"></omgdi:waypoint>
        <omgdi:waypoint x="122.0" y="418.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="64.0" width="100.0" x="35.0" y="331.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow26" id="BPMNEdge_flow26">
        <omgdi:waypoint x="905.0" y="767.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="766.0"></omgdi:waypoint>
        <omgdi:waypoint x="1008.0" y="307.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow27" id="BPMNEdge_flow27">
        <omgdi:waypoint x="122.0" y="481.0"></omgdi:waypoint>
        <omgdi:waypoint x="122.0" y="590.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow28" id="BPMNEdge_flow28">
        <omgdi:waypoint x="122.0" y="651.0"></omgdi:waypoint>
        <omgdi:waypoint x="122.0" y="741.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow29" id="BPMNEdge_flow29">
        <omgdi:waypoint x="176.0" y="771.0"></omgdi:waypoint>
        <omgdi:waypoint x="278.0" y="767.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>